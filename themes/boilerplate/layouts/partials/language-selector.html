{{/* Language Selector Partial */}}
{{ $hasMultipleLanguages := gt (len site.Home.AllTranslations) 1 }}

{{ if $hasMultipleLanguages }}
<div class="language-selector">
  <div class="flex flex-wrap items-center justify-center gap-3">
    {{ if .Translations }}
      <!-- Use page translations when available -->
      {{ range .Translations }}
        {{ $langCode := .Language.Lang }}
        
        <!-- Default to language code if BCP47 not available -->
        {{ $flagCode := $langCode }}
        {{ if eq $langCode "en" }}
          {{ $flagCode = "en-us" }}
        {{ end }}
        
        <a href="{{ .Permalink }}" 
           class="inline-flex items-center" 
           title="{{ .Language.LanguageName }}">
          <img src="{{ (printf "flags/%s.png" $flagCode) | relURL }}" 
               alt="{{ .Language.LanguageName }}" 
               class="w-6 h-4 hover:opacity-75 transition-opacity">
        </a>
      {{ end }}
    {{ else }}
      <!-- Fallback to all site languages -->
      {{ range .Site.Home.AllTranslations }}
        {{ if ne .Language.Lang $.Site.Language.Lang }}
          {{ $langCode := .Language.Lang }}
          
          <!-- Default to language code if BCP47 not available -->
          {{ $flagCode := $langCode }}
          {{ if eq $langCode "en" }}
            {{ $flagCode = "en-us" }}
          {{ end }}
          
          <a href="{{ .Permalink }}" 
             class="inline-flex items-center" 
             title="{{ .Language.LanguageName }}">
            <img src="{{ (printf "flags/%s.png" $flagCode) | relURL }}" 
                 alt="{{ .Language.LanguageName }}" 
                 class="w-6 h-4 hover:opacity-75 transition-opacity">
          </a>
        {{ end }}
      {{ end }}
    {{ end }}
  </div>
</div>
{{ end }}
