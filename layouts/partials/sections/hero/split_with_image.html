{{/*
Responsive hero section with split layout - content left, image/video right.

Parameters:
- type: "default" | "simple_base" | "features" | "integrations" | feature category (default: "default")
  - "default": Standard hero with image background
  - "simple_base": Simple hero without image (handled by hero_default.html, not this component)
  - "features": Generic features hero with icon overlay
  - "integrations": Integration hero with logo overlay
  - Feature categories: "promotional-materials", "reporting", "commissions", "user-interface", "tracking", "security"
    (automatically treated as features type with specific icon color)
- theme: "light" | "dark" | "alternate" (default: "light")
- image, imageAlt: Image settings
  - For type "default": Just background image, no overlay
  - For type "features" or feature categories: Background image + SVG icon overlay in square
  - For type "integrations": integration-detail.png background + logo overlay in square
- icon: SVG icon path (used only for features types)
- video: Video object with properties (optional, takes priority over image if enabled):
  - enabled: Boolean to enable video mode (default: false)
  - src: YouTube URL for the video
  - poster: Custom poster/thumbnail image for the video (falls back to imageUrl if not provided)
- eyebrow, heading, description: Text content
- cta: Call-to-action buttons
  - primary: Primary button (text, url)
  - secondary: Secondary button (text, url)
- tags: Array of tags (optional), will create tag links to /tags/[tag-name]/
- categories: Array of categories (optional), will create category links to /categories/[category-name]
- badges: Array of badge texts (optional), displayed as styled badges
- resources: Array of resource objects with 'name' and 'link' properties (optional), displayed as download buttons
- typewriter: Object with typewriter effect configuration (optional)
  - enabled: Boolean to enable/disable the effect (default: false)
  - words: Number of words to animate (default: 1)
  - speed: Typing speed in ms (default: 100)
  - deleteSpeed: Deleting speed in ms (default: 50)
  - pause: Pause duration in ms (default: 2000)
  - color: Color class for animated text (default: "text-indigo-600")
  - wordAlternatives: Comma separated words to alternate with
- sectionPaddingY: Custom vertical padding using Tailwind classes (default: "max-md:pt-0 py-12 lg:py-16")
- backgroundColor: Custom background color class
- overlayPosition: Position of icon overlay (default: "top-[5.69rem] left-[1.25rem]")
- overlaySize: Size of overlay container (default: "w-[7.88rem] h-[7.88rem]")
- overlayIconSizeIntegrations: Size of integration icons (default: "w-[6.25rem] h-[6.25rem]")
- overlayIconSizeFeatures: Size of feature icons (default: "w-[4.25rem] h-[4.25rem]")
- overlayShadowClass: CSS class for overlay shadow (default: "hero-overlay-shadow")
- contentLeftPadding: Left padding for content area (default: "lg:pr-0")

Image Handling by Type:
- type="default": Uses image parameter for background, no overlay square
- type="simple_base": Not handled by this component (uses simple_base.html instead)
- type="features": Uses image parameter for background, icon parameter for SVG overlay in square (green default color)
- type=feature category: Uses image parameter for background, icon parameter for SVG overlay with category-specific color
  - "tracking"=sky-600, "commissions"=yellow-600, "reporting"=fuchsia-600, etc.
- type="integrations": Uses /images/integration-methods/integration-detail.png for background, image parameter for logo overlay in square

Custom Color Classes Documentation:
- text-heading: Primary heading text color (typically dark for contrast)
- text-primary: Brand primary color for accents and CTAs
- text-secondary: Standard body text color (readable gray)
- text-gray-700: Tailwind gray-700 for secondary text
- section-bg-light: Light background for sections

Usage Guidelines:
- Use text-heading for main headings and emphasized text elements
- Use text-primary for brand accents, links, and call-to-action elements
- Use text-secondary for regular paragraph text and descriptions
- Ensure color contrast meets accessibility standards (WCAG AA)
- When video.enabled is true, video will be displayed with popup functionality
- Video supports YouTube URLs and will open in lightbox popup on click

Design Tokens:
- Image dimensions are configurable via variables for easy maintenance
- Spacing values use consistent design system tokens
- Typography tracking and sizing follow brand guidelines
- Media (image/video) is always positioned on the right side
*/}}

{{ $theme := .theme | default "light" }}
{{ $backgroundColor := .backgroundColor | default "" }}
{{ $isDark := eq $theme "dark" }}
{{ $isAlternate := eq $theme "alternate" }}

{{/* Section parameters */}}
{{ $type := .type | default "default" }}
{{ $image := .image }}
{{ $imageAlt := .imageAlt }}
{{ $icon := .icon }}
{{ $features := .features | default (slice) }}
{{ $video := .video | default (dict "enabled" false) }}
{{ $eyebrow := .eyebrow }}
{{ $heading := .heading }}
{{ $description := .description }}
{{ $cta := .cta }}
{{ $tags := .tags | default (slice) }}
{{ $categories := .categories | default (slice) }}
{{ $badges := .badges | default (slice) }}
{{ $resources := .resources | default (slice) }}
{{ $typewriter := .typewriter | default dict }}
{{ $search := .search | default dict }}

{{/* Typewriter configuration with defaults */}}
{{ $typewriter := merge (dict "enabled" false) $typewriter }}

{{/* Search configuration with defaults */}}
{{ $search := merge (dict "enabled" false) $search }}
{{ $search := merge (dict "directories" (slice)) $search }}
{{ $search := merge (dict "placeholder" (i18n "search_placeholder")) $search }}
{{ $search := merge (dict "searchFields" (slice "title" "content" "tags" "categories")) $search }}
{{ $typewriter := merge (dict "words" 1) $typewriter }}
{{ $typewriter := merge (dict "speed" 100) $typewriter }}
{{ $typewriter := merge (dict "deleteSpeed" 50) $typewriter }}
{{ $typewriter := merge (dict "pause" 2000) $typewriter }}
{{ $typewriter := merge (dict "color" "text-indigo-600") $typewriter }}
{{ $typewriter := merge (dict "wordAlternatives" "") $typewriter }}

{{/* Design tokens and configurable dimensions */}}
{{ $sectionPaddingY := .sectionPaddingY | default "max-md:pt-0 py-12 lg:py-16" }}
{{ $imageContainerPaddingY := "py-6" }}
{{ $contentPaddingY := "py-4" }}
{{ $contentLeftPadding := .contentLeftPadding | default "lg:pr-0" }}
{{ $headingTracking := "tracking-[-2.832px]" }}

{{/* Overlay configuration */}}
{{ $overlayPosition := .overlayPosition | default "top-[5.69rem] left-[1.25rem]" }}
{{ $overlaySize := .overlaySize | default "w-[7.88rem] h-[7.88rem]" }}
{{ $overlayIconSizeIntegrations := .overlayIconSizeIntegrations | default "w-[6.25rem] h-[6.25rem]" }}
{{ $overlayIconSizeFeatures := .overlayIconSizeFeatures | default "w-[4.25rem] h-[4.25rem]" }}
{{ $overlayShadowClass := .overlayShadowClass | default "hero-overlay-shadow" }}

{{/* Hero type configuration - clean and simple */}}

{{/* Feature category colors map */}}
{{ $featureColors := dict
  "promotional-materials" "text-green-600"
  "reporting" "text-fuchsia-600"
  "commissions" "text-yellow-600"
  "user-interface" "text-orange-300"
  "tracking" "text-sky-600"
  "security" "text-pink-600"
}}

{{/* Base config for Features (SVG Overlay mode) */}}
{{ $featureBaseConfig := dict 
    "customBackground" ""
    "showOverlay" true 
    "overlayMode" "svg"
}}

{{/* Base config for Integrations (Image Overlay mode) */}}
{{ $integrationConfig := dict 
    "customBackground" "/images/integration-methods/integration-detail.png"
    "showOverlay" true 
    "overlayMode" "image"
    "overlayColor" ""
}}

{{/* All Types Map: Defines all possible configurations */}}
{{ $allTypeConfigs := dict
  "integrations" $integrationConfig
  "features" (merge $featureBaseConfig (dict "overlayColor" "text-green-600"))
}}

{{/* Dynamically merge feature category configurations into the main map */}}
{{ range $category, $color := $featureColors }}
  {{ $categoryConfig := merge $featureBaseConfig (dict "overlayColor" $color) }}
  {{ $allTypeConfigs = merge $allTypeConfigs (dict $category $categoryConfig) }}
{{ end }}

{{/* Fallback (Default type has no overlay) */}}
{{ $defaultConfig := dict 
    "customBackground" "" 
    "showOverlay" false 
    "overlayMode" "none"
    "overlayColor" "" 
}}
{{ $config := index $allTypeConfigs $type | default $defaultConfig }}

{{/* Image processing */}}
{{ $imageSrc := "" }}
{{ $finalImageAlt := $imageAlt | default $heading | default .Title | default "Hero image" }}

{{/* Background image source logic */}}
{{ if $config.customBackground }}
  {{ $imageSrc = $config.customBackground }}
{{ else if $image }}
  {{ if reflect.IsMap $image }}
    {{ $imageSrc = $image.url }}
    {{ $finalImageAlt = $image.alt | default $finalImageAlt }}
  {{ else }}
    {{ $imageSrc = $image }}
  {{ end }}
{{ else }}
  {{ $imageSrc = "https://images.unsplash.com/photo-1487017159836-4e23ece2e4cf?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2102&q=80" }}
{{ end }}

{{/* Overlay icon source logic (Simplified by using overlayMode) */}}
{{ $showOverlay := $config.showOverlay }}
{{ $iconImageSrc := "" }}
{{ if eq $config.overlayMode "image" }}
  {{ $iconImageSrc = $image }}
{{ else if eq $config.overlayMode "svg" }}
  {{ $iconImageSrc = $icon }}
  {{ $showOverlay = and $showOverlay (ne $iconImageSrc "") }}
{{ end }}

<div class="split-with-image-hero {{ if $backgroundColor }}{{ $backgroundColor }}{{ else if $isDark }}dark section-bg-dark{{ else if $isAlternate }}section-bg-alternate{{ else }}section-bg-light{{ end }} {{ $sectionPaddingY }}">
  <div class="wrapper lg:flex lg:justify-between lg:items-stretch gap-x-8 lg:flex-row-reverse">
    <div class="lg:flex lg:w-1/2 lg:items-start lg:shrink lg:grow-0 xl:relative xl:inset-y-0 xl:left-0">
      <div class="max-md:hidden relative rounded-lg {{ $imageContainerPaddingY }} flex items-start justify-center w-full overflow-hidden mx-auto max-w-[38rem] max-h-[35rem]">
        {{ if and $video $video.enabled }}
          {{/* Display video with popup */}}
          {{ partial "components/media/video.html" (dict 
              "src" $video.src 
              "poster" $video.poster 
              "title" $heading
              "class" "rounded-lg w-full h-auto"
              "provider" "youtube"
              "playBtnClass" ""
              "posterHeight" "h-full"
              "useAspectRatio" false
              "showPlayButton" $video.showPlayButton
              "useLightbox" true
              "noLazy" true
          ) }}
        {{ else }}
          {{/* Display regular image */}}
          {{ if and $showOverlay $iconImageSrc }}
            <div class="absolute {{ $overlayPosition }} z-10 {{ $overlaySize }} rounded-xl border border-gray-200 bg-gradient-to-b from-gray-50 to-gray-50 opacity-80 flex items-center justify-center backdrop-blur-sm {{ $overlayShadowClass }}">
              {{ if eq $config.overlayMode "image" }}
                {{/* Integration logo (Image Overlay) */}}
                {{ partial "components/media/lazyimg.html" (dict
                  "src" $iconImageSrc
                  "alt" "Integration logo"
                  "class" (printf "%s object-contain" $overlayIconSizeIntegrations)
                  "noLazy" true
                ) }}
              {{ else if eq $config.overlayMode "svg" }}
                {{/* Feature SVG icon (SVG Overlay) */}}
                {{ partial "components/media/svg-icon.html" (dict
                  "src" $iconImageSrc
                  "alt" "Feature icon"
                  "class" (printf "%s %s" $overlayIconSizeFeatures $config.overlayColor)
                ) }}
              {{ end }}
            </div>
          {{ end }}
          {{ partial "components/media/lazyimg.html" (dict
              "src" $imageSrc
              "alt" $finalImageAlt
              "class" "object-contain rounded-lg"
              "noLazy" true
            ) }}
        {{ end }}
      </div>
    </div>
    <div class="lg:flex lg:w-1/2 lg:items-center">
      <div class="{{ $contentPaddingY }} lg:w-full lg:flex-none {{ $contentLeftPadding }}">
        {{ if $eyebrow }}
          <p class="text-base/7 font-semibold text-primary">{{ $eyebrow }}</p>
        {{ end }}
        {{ if $heading }}
          {{ $headingLength := len $heading }}
          {{ $lineHeightClass := "leading-tight" }}

          {{/* Get dynamic font classes from shared partial */}}
          {{ $fontConfig := partial "helpers/dynamic-font-classes.html" (dict "headingLength" $headingLength) }}
          {{ $fontSizeClass := $fontConfig.fontSizeClass }}
          {{ $headingTracking := $fontConfig.headingTracking }}
          
          {{/* Build typewriter attributes efficiently */}}
          {{ $typewriterAttrs := "" }}
          {{ if $typewriter.enabled }}
            {{ $typewriterAttrs = printf ` data-typewriter data-typewriter-words="%s" data-typewriter-word-alternatives="%s" data-typewriter-speed="%d" data-typewriter-delete-speed="%d" data-typewriter-pause="%d" data-typewriter-color="%s"` $typewriter.words $typewriter.wordAlternatives $typewriter.speed $typewriter.deleteSpeed $typewriter.pause $typewriter.color }}
          {{ end }}

          <h1 class="mt-6 {{ $fontSizeClass }} font-semibold {{ $headingTracking }} text-heading {{ $lineHeightClass }}" 
              data-dynamic-font 
              data-text-length="{{ $headingLength }}"{{ $typewriterAttrs | safeHTMLAttr }}>
            {{ $heading }}
          </h1>
        {{ end }}
        {{ if $description }}
          <p class="mt-8 text-lg/7 text-secondary sm:text-xl/8 prose-links">{{ $description | safeHTML }}</p>
        {{ end }}

        {{/* Tags, Categories, Badges and Resources */}}
        {{ if or $categories $tags $badges $resources }}
        <div class="mt-6 flex flex-col gap-4">
          {{ if $badges }}
          <div class="flex flex-wrap gap-2">
            {{ range $badges }}
              {{ partial "components/label/label.html" (dict 
                "text" . 
                "badgeClass" "badge-base badge-gray badge-with-border"
              ) }}
            {{ end }}
          </div>
          {{ end }}

          {{ if $categories }}
          {{ $categoriesEnabled := isset site.Taxonomies "categories" }}
          <div class="flex flex-wrap gap-2">
            {{ range $categories }}
            {{ if $categoriesEnabled }}
            <a href="{{ print "/categories/" (. | urlize) | relLangURL }}/" class="inline-flex items-center rounded-full bg-indigo-50 px-3 py-1 text-sm font-medium text-primary-dark hover:bg-indigo-100">
            {{ . }}
            </a>
            {{ else }}
            <span class="inline-flex items-center rounded-full bg-indigo-50 px-3 py-1 text-sm font-medium text-primary-dark">
            {{ . }}
            </span>
            {{ end }}
            {{ end }}
          </div>
          {{ end }}

          {{ if $tags }}
            {{ partial "sections/tags/tags.html" (dict "tags" $tags "maxTags" 4 ) }}
          {{ end }}

          {{ if $resources }}
            {{ partial "sections/resources/resources.html" (dict "resources" $resources "maxItems" 4) }}
          {{ end }}
        </div>
        {{ end }}

        {{/* CTA Buttons */}}
        {{ if $cta }}
          {{ $showPrimaryCta := and (isset $cta "primary") (isset $cta.primary "url") (isset $cta.primary "text") (ne $cta.primary.url "") (ne $cta.primary.text "") }}
          {{ $showSecondaryCta := and (isset $cta "secondary") (isset $cta.secondary "url") (isset $cta.secondary "text") (ne $cta.secondary.url "") (ne $cta.secondary.text "") }}
          {{ if or $showPrimaryCta $showSecondaryCta }}
          <div class="mt-10 flex items-center gap-x-6">
            {{ if $showPrimaryCta }}
              {{ partial "components/buttons/buttons.html" (dict
                "text" $cta.primary.text
                "url" $cta.primary.url
                "variant" "primary"
                "size" "xl"
              ) }}
            {{ end }}
            {{ if $showSecondaryCta }}
              {{ partial "components/buttons/buttons.html" (dict
                "text" $cta.secondary.text
                "url" $cta.secondary.url
                "variant" "secondary"
                "showArrow" true
                "size" "xl"
              ) }}
            {{ end }}
          </div>
          {{ end }}
        {{ end }}
        
        {{/* Search Field */}}
        {{ if $search.enabled }}
          <div class="mt-8 max-w-xl">
            {{ partial "search_field.html" (dict
              "type" "hero-search"
              "directories" $search.directories
              "placeholder" $search.placeholder
            ) }}
          </div>
        {{ end }}
      </div>
    </div>
  </div>
</div>

