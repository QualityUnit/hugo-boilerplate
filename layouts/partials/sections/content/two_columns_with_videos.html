{{/*
@section: Two Column With Videos
@description: A visually appealing layout featuring two columns with video content, ideal for showcasing video tutorials
@params:
  - theme: "light" or "dark" (default: "light") â€” applies dark mode styles if set to "dark"
  - eyebrow: Short text displayed above the main heading (optional, default: empty)
  - heading: Main section heading (optional, default: empty)
  - description: Short description text below the heading (optional, default: empty)
  - videos: Array of video objects with content (limited to maximum 2 videos)
    - title: Video title text (required)
    - description: Video description text (required)
    - src: Video URL (required)
    - url: Link to page on site (required)
    - poster: Image url (required)
@note: This section uses a two-column layout with text content on the left and videos on the right. 
       Videos use custom play button styling with two-circle design (gray outer circle, white inner circle, blue play icon).
       If no video src is provided, displays poster image with text overlay.
@example:
  {{ partial "sections/content/two_columns_with_videos.html" (dict
      "theme" "light"
      "eyebrow" "Video Tutorials"
      "heading" "Learn with Our Video Guides"
      "description" "Short description text below the heading"
      "videos" (slice
          (dict
              "title" "Responsive Design" 
              "description" "Our platform automatically adapts to any device or screen size."
              "src" "/videos/features/responsive.mp4"
              "url" "/affiliate-program-directory/"
              "poster" "/images/features/responsive.png"
          )
          (dict
              "title" "Analytics" 
              "description" "Detailed insights into your user behavior and application performance."
              "src" "/videos/features/analytics.mp4"
              "url" "/affiliate-program-directory/"
              "poster" "/images/features/analytics.png"
          )
      )
  ) }}
@note: This section uses a two-column layout with text content on the left and videos on the right. If no video src is provided, displays poster image with text overlay.
*/}}

{{/* Header parameters */}}
{{ $eyebrow := .eyebrow | default "" }}
{{ $heading := .heading | default "" }}
{{ $description := .description | default "" }}

{{/* Parse inner content as JSON if provided */}}
{{ $videos := (slice) }}
{{ with .Inner }}
  {{ if . }}
    {{ $videos = . | unmarshal }}
  {{ end }}
{{ end }}

{{/* If no Inner content, use videos parameter directly */}}
{{ if not $videos }}
  {{ $videos = .videos | default (slice) }}
{{ end }}

{{/* Theme setup */}}
{{ $theme := .theme | default "light" }}
{{ $isDark := eq $theme "dark" }}
{{ $darkClass := cond $isDark "dark" "" }}

<div class="{{ $darkClass }}">
  <div class="section-bg-light dark:section-bg-dark py-16 sm:py-24">
    <div class="wrapper">
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-16 items-center">
        
        {{/* Left Column - Text Content */}}
        <div>
          {{ if $eyebrow }}
            <p class="text-sm font-semibold uppercase tracking-wide text-primary mb-4">
              {{ $eyebrow }}
            </p>
          {{ end }}
          
          {{ if $heading }}
            <h2 class="text-3xl font-bold tracking-tight text-heading sm:text-4xl mb-6">
              {{ $heading }}
            </h2>
          {{ end }}
          
          {{ if $description }}
            <p class="text-lg text-body">
              {{ $description }}
            </p>
          {{ end }}
        </div>
        
        {{/* Right Column - Videos */}}
        <div>
          {{ if $videos }}
            <div class="space-y-8">
              {{ range $index, $video := (first 2 $videos) }}
                <div class="relative">
                  {{ if $video.src }}
                    {{/* Use custom video partial for video with popup */}}
                    {{ partial "components/media/video.html" (dict 
                        "src" $video.src 
                        "poster" $video.poster 
                        "title" $video.title
                        "class" "rounded-xl"
                        "provider" "youtube"
                        "useLightbox" true
                        "showPlayOverlay" true
                        "playBtnClass" "white-circle-bounce w-[7.75rem] h-[7.75rem] rounded-full backdrop-blur-sm"
                        "playBtnInnerClass" "bg-white w-24 h-24 rounded-full flex items-center justify-center hover:w-[6.25rem] hover:h-[6.25rem] transition-transform duration-300"
                        "svgIcon" "<svg width=\"35\" height=\"40\" viewBox=\"0 0 35 40\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M32.6329 17.285C34.5836 18.4487 34.5836 21.2739 32.6329 22.4377L5.19807 38.8052C3.19838 39.9982 0.661032 38.5574 0.661032 36.2289L0.661033 3.49381C0.661033 1.16528 3.19838 -0.275542 5.19807 0.917464L32.6329 17.285Z\" fill=\"#2563EB\"/></svg>"
                    ) }}
                  {{ else }}
                    {{/* Display poster image with text overlay if no video */}}
                    {{ partial "components/media/lazyimg.html" (dict 
                        "src" $video.poster 
                        "alt" ($video.title | default "") 
                        "class" "w-full h-auto"
                    ) }}
                  {{ end }}
                  {{ if or $video.title $video.description }}
                    <div class="absolute left-6 bottom-6 flex items-end z-30">
                        <div class="text-white">
                        {{ if $video.title }}
                            <h3 class="font-semibold text-opacity-75">{{ $video.title }}</h3>
                        {{ end }}
                        {{ if $video.description }}
                            <p class="text-sm mt-1.5 tracking-[-0.28px]">
                                {{ if $video.url }}
                                <a href="{{ $video.url }}" class="flex items-center text-white hover:underline">
                                    {{ $video.description }}
                                    <span class="ml-1 btn-arrow">
                                        {{ partial "components/media/icon.html" (dict "icon" "arrow-up-right" "class" "w-5 h-5 p-0.5") }}
                                    </span>
                                </a>
                                {{ else }}
                                    {{ $video.description }}
                                {{ end }}
                            </p>
                        {{ end }}
                        </div>
                    </div>
                    {{ end }}
                </div>
              {{ end }}
            </div>
          {{ end }}
        </div>
        
      </div>
    </div>
  </div>
</div>
