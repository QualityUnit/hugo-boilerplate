{{/*
Responsive two-column layout with image and rich content.

Parameters:
- theme: "light" | "dark" | "alternate" (default: "light")
- layout: "image-left" | "image-right" (default: "image-left")
- image, imageAlt, imageClass: Image settings 
- videoUrl: Video URL for embedding (default: "")
- poster: Video poster image URL (default: "")
- videoTitle: Video title text (default: "")
- videoDescription: Video description text (default: "")
- videoLinkUrl: Link to page on site from video overlay (default: "")
- eyebrow, heading, description: Text content
- link, linkText, buttonStyle: CTA button, showArrow (default: false)
- markdownContent, contentAsHTML: Main content
- features: [{icon, title, description}]
- numbered_features: [{title, description}] (features with numbers instead of icons)
- stats: [{number, label}]
- quote: {text, author, role, company, avatar}
- sectionVerticalSpacing: Custom vertical spacing parameter - for light theme uses margin classes (default: "my-24 sm:my-32"), for dark/alternate themes uses padding "py-24 sm:py-32"
- Color classes: *Color parameters for styling

Header section parameters:
- headerEyebrow, headerHeading, headerDescription: Header section content
- showHeader: Force header to render even without content
- headerAlignment: "left" (default), "center", or "right" for header text alignment
- headerPadding: Padding classes for the header section (default: "pb-24 lg:pb-32")

Custom Color Classes Documentation:
- text-heading: Primary heading text color (typically dark for contrast)
- text-primary: Brand primary color for accents and CTAs
- text-secondary: Standard body text color (readable gray)
- text-gray-700: Tailwind gray-700 for secondary text
- section-bg-light: Light background for sections

Usage Guidelines:
- Use text-heading for main headings and emphasized text elements
- Use text-primary for brand accents, links, and call-to-action elements
- Use text-secondary for regular paragraph text and descriptions
- Ensure color contrast meets accessibility standards (WCAG AA)

Design Tokens:
- Image dimensions are configurable via variables for easy maintenance
- Spacing values use consistent design system tokens
- Typography tracking and sizing follow brand guidelines
*/}}

{{ $theme := .theme | default "light" }}
{{ $backgroundColor := .backgroundColor | default "" }}
{{ $isDark := eq $theme "dark" }}
{{ $isAlternate := eq $theme "alternate" }}

{{/* Section parameters */}}
{{ $layout := .layout | default "image-left" }}
{{ $image := .image }}
{{ $imageAlt := .imageAlt }}
{{ $imageClass := .imageClass | default "object-contain rounded-lg" }}
{{ $mediaContainerPaddingY := .mediaContainerPaddingY | default "py-6" }}

{{ $videoUrl := .videoUrl | default "" }}
{{ $poster := .poster | default "" }}
{{ $posterHeight := .posterHeight | default "h-full" }}
{{ $videoTitle := .videoTitle | default "" }}
{{ $videoDescription := .videoDescription | default "" }}
{{ $videoLinkUrl := .videoLinkUrl | default "" }}
{{ $provider := .provider | default "youtube" }}
{{ $pureVideo := .pureVideo | default false }}

{{ $eyebrow := .eyebrow }}
{{ $heading := .heading }}
{{ $description := .description }}
{{ $link := "" }}
{{ if .link }}
  {{ $link = partial "helpers/get-translated-url.html" (dict "url" .link) }}
{{ end }}
{{ $linkText := .linkText }}
{{ $linkTarget := .linkTarget | default "_self" }}
{{ $buttonStyle := .buttonStyle | default "primary" }}
{{ $showArrow := .showArrow | default false }}
{{ $markdownContent := .markdownContent }}
{{ $contentAsHTML := .contentAsHTML | default false }}
{{ $features := .features | default (slice) }}
{{ $numbered_features := .numbered_features | default (slice) }}
{{ $stats := .stats | default (slice) }}
{{ $quote := .quote }}
{{ $imageGallery := .imageGallery | default (dict) }}

{{/* Header parameters */}}
{{ $headerEyebrow := .headerEyebrow | default "" }}
{{ $headerHeading := .headerHeading | default "" }}
{{ $headerDescription := .headerDescription | default "" }}
{{ $showHeader := .showHeader | default false }}
{{ $headerAlignment := .headerAlignment | default "left" }}
{{ $headerPadding := .headerPadding | default "pb-24 lg:pb-32" }}

{{/* Design tokens and configurable dimensions */}}
{{ $sectionVerticalSpacing := .sectionVerticalSpacing | default "my-24 sm:my-32" }}
{{ $finalSpacing := cond (or $isDark $isAlternate) "py-24 sm:py-32" $sectionVerticalSpacing }}
{{ $mediaContainerPaddingY := .mediaContainerPaddingY | default "py-6" }}
{{ $contentPaddingY := "py-4" }}
{{ $contentLeftPadding := "lg:pl-20" }}
{{ $headingTracking := "tracking-[-2.832px]" }}

<div class="split-with-image-section {{ if $backgroundColor }}{{ $backgroundColor }}{{ else if $isDark }}dark section-bg-dark{{ else if $isAlternate }}section-bg-alternate{{ else }}section-bg-light{{ end }} {{ $finalSpacing }}">
  {{/* Render header if header parameters are provided */}}
  {{ if or $headerHeading $headerEyebrow $headerDescription $showHeader }}
    {{ partial "layout/headers/simple_with_eyebrow_base.html" (dict 
      "eyebrow" $headerEyebrow
      "heading" $headerHeading 
      "description" $headerDescription
      "alignment" $headerAlignment
      "padding" $headerPadding
    ) }}
  {{ end }}
  <div class="wrapper flex flex-col lg:flex-row lg:justify-between lg:items-stretch {{ if not $videoUrl }}gap-x-8{{ end }}{{ if eq $layout "image-right" }} lg:flex-row-reverse{{ end }}">
    <div class="lg:flex lg:w-1/2 lg:items-start lg:shrink lg:grow-0 xl:relative xl:inset-y-0 {{ if eq $layout "image-right" }}xl:left-0{{ else }}xl:right-0{{ end }}">
      <div class="group/video relative rounded-lg {{ $mediaContainerPaddingY }} flex items-start justify-center w-full mx-auto max-w-[38rem] {{ if $videoUrl }}h-full overflow-hidden max-h-[35rem]{{ end }}">
        {{ if $videoUrl }}
          <div class="relative flex w-full h-full">
            {{/* Display video */}}
            {{ partial "components/media/video.html" (dict 
                  "src" $videoUrl 
                  "poster" $poster
                  "posterHeight" $posterHeight
                  "title" $videoTitle
                  "class" "rounded-xl h-full"
                  "provider" $provider
                  "pureVideo" $pureVideo
                  "useLightbox" true
                  "showPlayOverlay" true
                  "playBtnClass" "white-circle-bounce size-[5.5rem] md:size-[7.75rem] rounded-full backdrop-blur-[3px]"
                  "playBtnInnerClass" "bg-white relative size-[4.5rem] md:size-24 rounded-full hover:scale-105 transition-transform duration-300"
                  "svgClass" "size-10 md:size-14 ml-1 text-[#4F46E5] absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"
              ) }}
              {{ if or $videoTitle $videoDescription }}
              <div class="absolute left-5 bottom-5 flex items-end z-30">
                  <div class="text-white">
                  {{ if $videoTitle }}
                      <h3 class="font-semibold text-opacity-75">{{ $videoTitle }}</h3>
                  {{ end }}
                  {{ if $videoDescription }}
                      <p class="text-sm mt-1.5 tracking-[-0.28px] group-hover/video:underline">
                          {{ if $videoLinkUrl }}
                          <a href="{{ partial "helpers/get-translated-url.html" (dict "url" $videoLinkUrl) }}" class="flex items-center text-white ">
                              {{ $videoDescription }}
                              <span class="ml-1 btn-arrow">
                                  {{ partial "components/media/icon.html" (dict "icon" "arrow-up-right" "class" "w-5 h-5 p-0.5") }}
                              </span>
                          </a>
                          {{ else }}
                              {{ $videoDescription }}
                          {{ end }}
                      </p>
                  {{ end }}
                  </div>
              </div>
            {{ end }}
          </div>
        {{ else if $image }}
          {{/* Display image */}}
          <div class="relative w-full">
              {{ if $link }}
                <a href="{{ $link }}" target="{{ $linkTarget }}"{{ if eq $linkTarget "_blank" }} rel="noopener noreferrer"{{ end }} class="block">
              {{ end }}
                  {{ partial "components/media/lazyimg.html" (dict
                    "src" $image
                    "alt" $imageAlt
                    "class" (printf "%s rounded-lg" $imageClass)
                  ) }}
              {{ if $link }}
                </a>
              {{ end }}
          </div>
        {{ end }}
      </div>
    </div>
    <div class="max-md:-order-1 lg:flex lg:w-1/2 lg:items-center {{ if $videoUrl }}lg:pr-8{{ end }}">
      <div class="{{ $contentPaddingY }} lg:w-full lg:flex-none {{ if eq $layout "image-right" }}lg:pr-20{{ else }}{{ $contentLeftPadding }} {{ end }}">
        {{ if $eyebrow }}
          <p class="text-base/7 font-semibold product-text">{{ $eyebrow }}</p>
        {{ end }}
        {{ if $heading}}
          <h2 class="mt-3  mb-0 text-4xl font-semibold {{ $headingTracking }}  text-heading leading-none text-pretty sm:text-5xl">{{ $heading }}</h2>
        {{ end }}
        {{ if $description }}
          <p class="mt-6 text-lg/7 text-secondary prose-links">{{ $description | safeHTML }}</p>
        {{ end }}

        {{/* Features */}}
        {{ if $features }}
        <dl class="mt-6 max-w-full space-y-3 text-normal text-secondary lg:max-w-full">
          {{ range $features }}
          <div class="relative pl-9">
            <dt class="inline {{ if .description }}font-bold{{ end }} text-heading">
              {{ if .icon }}
                <span class="absolute left-1 top-1 size-5 text-primary">
                  {{ partial "components/media/icon.html" (dict "icon" .icon) }}
                </span>
              {{ end }}
              {{ .title }}{{ if .description }}: {{ end }}
            </dt>
            {{ if .description }}
              <dd class="inline prose-links">{{ .description }}</dd>
            {{ end }}
          </div>
          {{ end }}
        </dl>
        {{ end }}

        {{/* Numbered Features */}}
        {{ if $numbered_features }}
          <ol class="mt-6 max-w-full space-y-3 text-normal text-secondary lg:max-w-full">
            {{ range $index, $feature := $numbered_features }}
              <li class="relative pl-9">
                <span class="inline-flex text-heading font-bold">
                  <span class="absolute left-1 top-1/2 -translate-y-1/2 w-5 h-5 text-[10px] flex justify-center items-center text-white rounded-full bg-primary">{{ add $index 1 }}</span>
                  {{ .title }}{{ if .description }}: {{ end }}
                </span>
                <span class="inline prose-links">{{ .description }}</span>
              </li>
            {{ end }}
          </ol>
        {{ end }}

        {{/* Stats */}}
        {{ if $stats }}
          <dl class="mt-10 grid max-w-full grid-cols-1 gap-8 sm:grid-cols-2">
            {{ range $stats }}
            <div class="flex flex-col gap-y-3 border-l border-gray-900/10 pl-6">
              <dt class="text-sm/6 text-secondary">{{ .label }}</dt>
              <dd class="order-first text-3xl font-semibold tracking-tight text-heading">{{ .number }}</dd>
            </div>
            {{ end }}
          </dl>
        {{ end }}

        {{/* Quote */}}
        {{ if $quote }}
          <div class="lg:max-w-full">
            <figure class="mt-10 border-l border-gray-200 pl-8 text-secondary">
              <blockquote class="text-base/7 prose-links">
                <p>"{{ $quote.text }}"</p>
              </blockquote>
              <figcaption class="mt-6 flex gap-x-4 text-sm/6">
                {{ if $quote.avatar }}
                {{ $avatarUrlWithDomain := partial "functions/get-static-url.html" (dict "path" $quote.avatar) }}
                <img src="{{ $avatarUrlWithDomain }}" alt="{{ $quote.author }}" class="size-6 flex-none rounded-full" />
                {{ end }}
                <div>
                  <span class="font-semibold text-heading">{{ $quote.author }}</span>
                  {{ if $quote.role }} â€“ {{ $quote.role }}{{ end }}{{ if $quote.company }}, {{ $quote.company }}{{ end }}
                </div>
              </figcaption>
            </figure>
          </div>
        {{ end }}

        {{/* Main content */}}
        {{ if $markdownContent }}
          <div class="mt-10 max-w-full text-secondary prose-links lg:max-w-full [&_p]:mb-5 [&_h1]:mb-5 [&_h2]:mb-5 [&_h3]:mb-5 [&_h4]:mb-5 [&_h5]:mb-5 [&_h6]:mb-5 [&_ul]:mb-5 [&_ol]:mb-5 [&_*:last-child]:mb-0 [&_pre]:overflow-x-hidden [&_pre]:whitespace-pre-wrap [&_pre]:break-words [&_pre]:font-sans [&_code]:whitespace-pre-wrap [&_code]:break-words [&_code]:font-sans">
            {{ if $contentAsHTML }}
                {{ $markdownContent | safeHTML }}
            {{ else }}
                {{ $markdownContent | markdownify }}
            {{ end }}
          </div>
        {{ end }}

        {{/* Image Gallery */}}
        {{ if $imageGallery }}
          {{ if or $imageGallery.title $imageGallery.images }}
            <div class="mt-6">
              {{ if $imageGallery.images }}
                {{ if $imageGallery.title }}
                  <h4 class="font-semibold text-secondary mb-6">{{ $imageGallery.title }}</h4>
                {{ end }}
                <div class="flex flex-wrap gap-2 opacity-70 max-h-9">
                  {{ range $imageGallery.images }}
                    <div class="relative overflow-hidden">
                      {{ partial "components/media/lazyimg.html" (dict
                        "src" .src
                        "alt" (.alt | default "Gallery image")
                        "class" "object-contain w-auto h-8"
                      ) }}
                    </div>
                  {{ end }}
                </div>
              {{ end }}
            </div>
          {{ end }}
        {{ end }}

        {{/* Button */}}
        {{ if $link }}
        <div class="mt-6">
          {{ partial "components/buttons/buttons.html" (dict
            "text" $linkText
            "url" $link
            "target" $linkTarget
            "variant" $buttonStyle
            "showArrow" $showArrow
          ) }}
        </div>
        {{ end }}
      </div>
    </div>
  </div>
</div>
