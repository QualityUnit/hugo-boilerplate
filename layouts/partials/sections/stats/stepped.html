{{/*
@section: Stepped Stats
@description: A dynamic statistics section featuring multiple stat cards with varied sizes, background colors, and alignments, creating a visually striking "stepped" layout.
@params:
  - padding: Padding classes (optional, default: "py-24")
  - showHeading: Whether to display the heading section (optional, default: true)
  - heading: Main section heading (optional, default: "")
  - description: Section description text (optional, default: "")
  - stats: Array of statistic objects (optional, includes defaults)
    - value: The statistic value to display
    - title: Title for the statistic
    - description: Detailed description of the statistic
    - verticalSpacing: Vertical spacing class for the card (optional, default: varies by position)
@example:
  {{ partial "sections/stats/stepped.html" (dict 
      "heading" "Our Impact by the Numbers" 
      "description" "We're transforming the way businesses operate with measurable results across our platform."
      "stats" (slice
          (dict 
              "value" "500K+" 
              "title" "Active users on our platform"
              "description" "Our growing community of users drives innovation and engagement across our ecosystem."
              "verticalSpacing" "md:gap-y-10"
          )
          (dict 
              "value" "$12.5M" 
              "title" "Revenue generated by our customers using our platform solutions"
              "description" "We help businesses grow and succeed with our powerful tools."
              "verticalSpacing" "md:gap-y-44"
          )
          (dict 
              "value" "99.99%" 
              "title" "Platform uptime over the past year"
              "description" "Reliability you can count on. Our infrastructure is built for mission-critical applications."
              "verticalSpacing" "md:gap-y-12"
          )
      )
  ) }}
@note: This component creates visual interest through its asymmetrical layout and varied card designs. The responsive design adapts from a stacked mobile view to a stepped desktop layout.
*/}}

{{/* Configurable variables */}}
{{ $padding := .padding | default "py-24" }}

{{/* Heading */}}
{{ $showHeading := .showHeading | default true }}
{{ $heading := .heading | default "" }}
{{ $description := .description | default "" }}

{{/* Stats */}}
{{ $stats := .stats | default slice }}

<div class="bg-white {{ $padding }}">
  <div class="wrapper px-6 md:px-8">
    {{ if $showHeading }}
      <div class="mx-auto md:max-w-2xl md:mx-0">
        <h2 class="text-4xl font-semibold tracking-tight text-pretty text-heading sm:text-5xl">{{ $heading }}</h2>
        <p class="mt-6 text-lg/7 text-secondary prose-links">{{ $description | safeHTML }}</p>
      </div>
    {{ end }}

    {{/* Hidden safelist to ensure Tailwind includes md:gap-y utilities in the final build */}}
    {{ $verticalSpacingClasses := slice "md:gap-y-12" "md:gap-y-16" "md:gap-y-20" "md:gap-y-24" "md:gap-y-28" "md:gap-y-32" "md:gap-y-36" "md:gap-y-40" "md:gap-y-44" "md:gap-y-48" "md:gap-y-52" "md:gap-y-56" "md:gap-y-60" "md:gap-y-64" "md:gap-y-72" "md:gap-y-80" "md:gap-y-96" }}
    <div class="hidden">
      {{ range $verticalSpacingClasses }}<div class="{{ . }}"></div>{{ end }}
    </div>

    <div class="mx-auto mt-16 flex flex-col gap-8 md:mx-0 md:mt-20 md:max-w-none md:flex-row md:items-end">
      {{ range $index, $stat := $stats }}
        {{ $width := $stat.width | default "w-full md:w-1/3" }}
        
        {{/* Calculate vertical spacing - allow custom override or use defaults based on position */}}
        {{ $verticalSpacing := "" }}
        {{ if or $stat.verticalSpacing $stat.spacing }}
          {{ $verticalSpacing = $stat.verticalSpacing | default $stat.spacing }}
        {{ else }}
          {{ if eq $index 0 }}
            {{ $verticalSpacing = "md:gap-y-20" }}
          {{ else if eq $index 1 }}
            {{ $verticalSpacing = "md:gap-y-40" }}
          {{ else if eq $index 2 }}
            {{ $verticalSpacing = "md:gap-y-16" }}
          {{ else }}
            {{ $verticalSpacing = "md:gap-y-12" }}
          {{ end }}
        {{ end }}

        {{/* Define card styles based on position */}}
        {{ $cardStyles := dict }}
        {{ if eq $index 0 }}
          {{ $cardStyles = dict "bg" "bg-gray-200" "value" "text-heading" "title" "text-heading" "desc" "text-secondary" }}
        {{ else if eq $index 1 }}
          {{ $cardStyles = dict "bg" "bg-gray-900" "value" "text-white" "title" "text-white" "desc" "text-white" }}
        {{ else if eq $index 2 }}
          {{ $cardStyles = dict "bg" "surface-brand" "value" "text-white" "title" "text-white" "desc" "text-white" }}
        {{ else }}
          {{ $cardStyles = dict "bg" "bg-gray-200" "value" "text-heading" "title" "text-heading" "desc" "text-secondary" }}
        {{ end }}

        <div class="flex flex-col justify-between gap-x-16 gap-y-8 rounded-2xl {{ index $cardStyles "bg" }} p-8 md:p-4 lg:p-8  sm:flex-row-reverse sm:items-end {{ $width }} md:flex-col md:items-start {{ $verticalSpacing }}">
          <p class="flex-none text-3xl font-bold tracking-tight {{ index $cardStyles "value" }}">{{ $stat.value }}</p>
          <div class="sm:w-80 sm:shrink md:w-auto md:flex-none">
            <p class="text-lg font-semibold tracking-tight {{ index $cardStyles "title" }}">{{ $stat.title }}</p>
            <p class="mt-2 text-base/6 {{ index $cardStyles "desc" }}">{{ $stat.description }}</p>
          </div>
        </div>
      {{ end }}
    </div>
  </div>
</div>
