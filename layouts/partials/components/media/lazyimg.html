{{/*
@component: Lazy Image
@description: Directs to the appropriate lazy image loading component based on URL type. For images only.
@params:
  - src: Path to the source image (required)
  - alt: Alternative text for accessibility (required)
  - description: Text under the image
  - class: Additional CSS classes (optional)
  - id: Image ID (optional)
  - width: Image width (optional)
  - height: Image height (optional)
  - maxWidth: Maximum image width for loading (optional)
  - noLazy: Set to true to disable lazy loading (for hero images, above-the-fold content) (optional)
  - link: URL to wrap the image in a clickable link (optional)
@example:
  {{ partial "components/media/lazyimg.html" (dict 
      "src" "/images/example.jpg" 
      "alt" "Example image" 
      "description" "Source: <a href='https://www.shutterstock.com/'>Shutterstock</a>"
      "class" "rounded-lg shadow-md"
  ) }}
  
  {{ partial "components/media/lazyimg.html" (dict 
      "src" "/images/hero-banner.jpg" 
      "alt" "Hero banner" 
      "class" "hero-image"
      "noLazy" true
  ) }}
*/}}

{{ $src := .src }}
{{ $description := .description }}
{{ $link := .link | default "" }}

<figure class="text-center">
  {{ if $link }}<a href="{{ $link }}">{{ end }}
  {{ if $src }}
    {{ if or (hasPrefix $src "http://") (hasPrefix $src "https://") }}
      {{ partial "components/media/lazyimg_external.html" . }}
    {{ else }}
      {{ partial "components/media/lazyimg_internal.html" . }}
    {{ end }}
  {{ end }}
  {{ if $link }}</a>{{ end }}
  {{ if $description }}
    <figcaption>{{ $description | safeHTML }}</figcaption>
  {{ end }}
</figure>
