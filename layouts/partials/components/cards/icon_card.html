{{/*
@component: Icon Card
@description: Displays a component card with icon, title, description and button. Designed for component listings.
@params:
- icon: Icon name (e.g., "light-bulb") for Hugo icon partials or SVG file path (e.g., "/images/icons/code.svg")
- title: Card title
- description: Card description text
- buttonText: Text for the button (optional, default: "Learn More")
- buttonLink: URL for the button link
- cardClass: Additional CSS classes for the card container (optional)
- iconColor: Color class for the icon (optional, default: text-gray-900)
- iconBackground: Background class for the icon (optional)
- iconSize: Size class for the icon (optional, default: w-5 h-5)
- iconBackgroundSize: Size class for the icon background (optional, default: w-10 h-10)
- headingLevel: HTML heading level for the title (optional, default: h3) - accepts h1, h2, h3, h4, h5, h6
- descriptionLines: Number of lines to show for description (optional, default: 3) - accepts 1-6
@example:
{{ partial "components/cards/icon_card.html" (dict
    "icon" "light-bulb"
    "title" "Smart Solutions"
    "description" "Innovative ideas for your business"
    "url" "/solutions/"
) }}
{{ partial "components/cards/icon_card.html" (dict
    "icon" "/images/icons/code.svg"
    "title" "Code Generator"
    "description" "Generate clean, efficient code automatically"
    "url" "/tools/code-generator"
    "headingLevel" "h2"
) }}
@note: Supports Hugo icon partials (use icon name without path) and SVG file paths (use full path with /images/).
*/}}

{{/*
Tailwind safelist - dynamic icon background colors from data/components/iconColors.yaml:
bg-indigo-600 bg-pink-700 bg-teal-400 bg-pink-500 bg-purple-600 bg-blue-600
bg-orange-500 bg-orange-600 bg-orange-400 bg-green-500 bg-red-600 bg-blue-800
bg-yellow-500 bg-teal-600 bg-red-900 bg-green-700 bg-[#f59e0b] bg-[#021049]
bg-[#b28b5d] bg-[#611f69] bg-[#95bf47] bg-[#2684fc] bg-[#00ac47] bg-[#0066da] bg-[#00749c]
*/}}

{{ $icon := .icon }}
{{ $iconSize := .iconSize | default "w-5 h-5" }}
{{ $iconBackgroundSize := .iconBackgroundSize | default "w-10 h-10" }}
{{ $title := .title }}
{{ $description := .description }}
{{ $buttonText := printf "%s %s" (i18n "icon.card.btn") $title }}
{{ $buttonLink := .url }}
{{ $cardClass := .cardClass | default "" }}
{{ $iconCategory := .iconBackgroundCategory }}
{{ $iconColors := site.Data.components.iconColors }}
{{ $iconBackground := "bg-red-900" }}
{{ if .iconBackground }}
  {{ $iconBackground = .iconBackground }}
{{ else if and $iconCategory (ne $iconCategory "") (index $iconColors $iconCategory) }}
  {{ $iconBackground = index $iconColors $iconCategory }}
{{ end }}
{{ $iconAlt := .iconAlt }}
{{ $iconColor := .iconColor | default "text-gray-900" }}
{{ $isIconName := and $icon (not (strings.Contains $icon "/")) (not (strings.Contains $icon ".")) }}
{{ $headingLevel := .headingLevel | default "h3" }}
{{ $descriptionLines := .descriptionLines | default 3 }}
{{ $lineClampClass := "line-clamp-3" }}
{{ if eq $descriptionLines 0 }}{{ $lineClampClass = "" }}
{{ else if eq $descriptionLines 1 }}{{ $lineClampClass = "line-clamp-1" }}
{{ else if eq $descriptionLines 2 }}{{ $lineClampClass = "line-clamp-2" }}
{{ else if eq $descriptionLines 3 }}{{ $lineClampClass = "line-clamp-3" }}
{{ else if eq $descriptionLines 4 }}{{ $lineClampClass = "line-clamp-4" }}
{{ else if eq $descriptionLines 5 }}{{ $lineClampClass = "line-clamp-5" }}
{{ else if ge $descriptionLines 6 }}{{ $lineClampClass = "line-clamp-6" }}
{{ end }}

<div class="surface-secondary border-gray-primary rounded-xl p-8 {{ $cardClass }}">
    {{ if $icon }}
        <div class="mb-4">
            <div class="{{ $iconBackgroundSize }} flex items-center justify-center rounded-lg {{ $iconBackground}}">
                {{ if $isIconName }}
                    {{/* Use Hugo icon partial for icon names (e.g., "light-bulb") */}}
                    {{ partial (printf "icons/%s" $icon) (printf "%s %s flex-shrink-0" $iconSize $iconColor) }}
                {{ else }}
                    {{/* Use lazyimg_internal for file paths (e.g., "/images/icons/icon.svg") */}}
                    {{ partial "components/media/lazyimg_internal.html" (dict
                        "src" $icon
                        "alt" $iconAlt
                        "class" (printf "%s %s flex-shrink-0" $iconSize $iconColor)
                    ) }}
                {{ end }}
            </div>
        </div>
    {{ end }}

    {{ if $title }}
        {{ if eq $headingLevel "h1" }}
            <h1 class="mt-2 text-lg font-semibold text-heading">{{ $title }}</h1>
        {{ else if eq $headingLevel "h2" }}
            <h2 class="mt-2 text-lg font-semibold text-heading">{{ $title }}</h2>
        {{ else if eq $headingLevel "h3" }}
            <h3 class="mt-2 text-lg font-semibold text-heading">{{ $title }}</h3>
        {{ else if eq $headingLevel "h4" }}
            <h4 class="mt-2 text-lg font-semibold text-heading">{{ $title }}</h4>
        {{ else if eq $headingLevel "h5" }}
            <h5 class="mt-2 text-lg font-semibold text-heading">{{ $title }}</h5>
        {{ else if eq $headingLevel "h6" }}
            <h6 class="mt-2 text-lg font-semibold text-heading">{{ $title }}</h6>
        {{ else }}
            <h3 class="mt-2 text-lg font-semibold text-heading">{{ $title }}</h3>
        {{ end }}
    {{ end }}

    {{ if $description }}
        <p class="mt-1 text-secondary text-base {{ $lineClampClass }} not-prose">
            {{ $description }}
        </p>
    {{ end }}
    
    {{ if $buttonLink }}
        <div class="mt-5">
            {{ partial "components/buttons/buttons.html" (dict
                "text" $buttonText
                "url" $buttonLink
                "variant" "secondary"
            ) }}
        </div>
    {{ end }}
</div>