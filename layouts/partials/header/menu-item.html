{{/*
@component: Header Menu Item
@description: Universal menu item component with promotional support. Renders a single top-level menu item with language-specific URL support and optional promotional badges.
@params:
  - MenuItem (object): The menu item object to render.
  - Lang (string): Current language code (e.g., "en", "uk").
@features:
  - Language-specific URL support
  - Promotional badge support (controlled by site.Params.promotional.enabled and item.Params.promo)
  - Icon support
  - External link indicators
  - Accessibility attributes
@example:
{{ partial "header/menu-item.html" (dict "MenuItem" . "Lang" $curLang) }}
@requirements:
  - site.Params.promotional.enabled (boolean): Global promotional mode toggle
  - item.Params.promo (boolean): Individual menu item promotional flag
  - i18n "promo_offer": Translation for promotional badge text
*/}}

{{- $curLang := .Lang -}}
{{- $item := .MenuItem -}}
{{- $site := site -}}

{{- $url := $item.URL | default "#" -}}
{{- $renderTextPartial := "header/helpers/render-text.html" -}}

{{- /* Get properly translated URL */ -}}
{{- $url = partial "helpers/get-translated-url.html" (dict "url" $url "lang" $curLang) -}}

{{- /* Extract other attributes directly from item.Params */ -}}
{{- $target := $item.Params.target | default "_self" -}}
{{- $rel := $item.Params.rel | default "" -}}
{{- if eq $target "_blank" -}}
  {{- if not $rel -}}
    {{- $rel = "noopener noreferrer" -}}
  {{- else -}}
    {{- if not (strings.Contains $rel "noopener") -}}
      {{- $rel = printf "%s noopener" (strings.TrimSpace $rel) -}}
    {{- end -}}
    {{- if not (strings.Contains $rel "noreferrer") -}}
      {{- $rel = printf "%s noreferrer" (strings.TrimSpace $rel) -}}
    {{- end -}}
  {{- end -}}
{{- end -}}
{{- $targetAttr := "" -}} {{- if ne $target "_self" -}} {{- $targetAttr = printf " target=\"%s\"" $target -}} {{- end -}}
{{- $relAttr := "" -}} {{- with $rel -}} {{- $relAttr = printf " rel=\"%s\"" . -}} {{- end -}}
{{- $ariaAttr := "" -}} {{- with $item.Params.ariaLabel -}} {{- $ariaAttr = printf " aria-label=\"%s\"" . -}} {{- end -}}
{{- $dataAttr := $item.Params.dataAttr | default "" -}}

{{- $icon := $item.Params.icon -}}
{{- $promo := $item.Params.promo | default false -}}

{{- $title := partial $renderTextPartial (dict "text" $item.Name) -}}

{{- if and site.Params.promotional.enabled $promo -}}<div class="relative">{{- end -}}
<a href="{{- $url -}}"
  class="flex items-center gap-x-1 text-base lg:text-sm/6 font-semibold text-heading"
  {{$targetAttr}}{{$relAttr}}{{$ariaAttr}}{{$dataAttr}}>
  {{- if $icon -}}
    {{- partial (printf "icons/%s" $icon) "w-5 h-5 mr-2 text-tertiary" -}}
  {{- end -}}

  <div class="flex items-center gap-x-1.5">
    {{- $title -}}
    {{- if eq $item.Params.target "_blank" -}}
      {{- partial "icons/arrow-top-right-on-square" "inline-block ml-1 h-4 w-4" -}}
    {{- end -}}
  </div>
</a>
{{- if and site.Params.promotional.enabled $promo -}}
  {{- $limitedOfferText := i18n "promo_offer_in_menu" | default "-75% OFF" -}}
  <span class="absolute right-0 pointer-events-none px-2 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded-full whitespace-nowrap shadow-sm top-0 translate-x-0 lg:-top-[17px] lg:translate-x-[70%]">{{- $limitedOfferText -}}</span>
</div>
{{- end -}}